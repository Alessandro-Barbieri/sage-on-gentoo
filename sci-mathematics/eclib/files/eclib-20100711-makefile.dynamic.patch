--- Makefile.dynamic.orig	2009-12-05 22:00:27.000000000 +1300
+++ Makefile.dynamic	2009-12-05 23:28:01.000000000 +1300
@@ -5,15 +5,14 @@
 DY_LIBNAME=$(LIBBASE).dylib
 SO_LIBNAME=$(LIBBASE).so
 DLL_LIBNAME=$(LIBBASE).dll
-A_LIBNAME=$(LIBBASE).a

 $(DY_LIBNAME): $(A_LIBNAME)
 	$(CXX) $(DYN_OPTS) $(DYN_FLAGS) $(A_LIBNAME) $(OBJS) -o $(DY_LIBNAME) $(NTLLFLAGS) $(LIBFLAGS)
 install_$(DY_LIBNAME), install_dylib: $(DY_LIBNAME)
 	cp $(DY_LIBNAME) $(LIBDIR)/

-$(SO_LIBNAME): $(A_LIBNAME)
-	$(CXX) $(SO_OPTS)  $(A_LIBNAME) $(OBJS) -o $(SO_LIBNAME) $(NTLLFLAGS) $(LIBFLAGS)
+$(SO_LIBNAME): $(SOBJS)
+	$(CXX) $(SO_OPTS) -Wl,-soname,$(SO_LIBNAME) $(SOBJS) -o $(SO_LIBNAME) $(NTLLFLAGS) $(LIBFLAGS)
 install_$(SO_LIBNAME), install_so: $(SO_LIBNAME)
 	cp $(SO_LIBNAME) $(LIBDIR)/

